{% extends 'base.html' %}

{% block stylesheet %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/details.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/edit.css') }}">
{% endblock %}

{% block script %}
<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>  
<script defer src="{{ url_for('static', filename='js/edit.js') }}"></script>
{% endblock %}

{% block header %}Edit{% endblock %}

{% block content %}

<form class="details" id="edit-form">

    <div id="backButton">
        <a href="javascript:history.back()">
            <img src="{{ url_for('static', filename='assets/back_icon.png') }}"
             style="width: 40px"
             alt="Back Button">
        </a>
    </div>

    <h1>Edit</h1>


    <div class="edit-block" id="edit-name">
        <strong>Name*</strong>
        <input type="text" name="name" 
            value="{% if equipment['name'] %}{{ equipment['name'] }}{% endif %}"/>
    </div>

    <div class="edit-block" id="edit-overview">
        <label for="edit-overview"><strong>Overview*</strong></label>
        <textarea type="text" name="overview">{% if equipment['overview'] %}{{ equipment['overview'] }}{% endif %}</textarea>
    </div>

    <div class="edit-block" id="edit-images">
        <label for="edit-overview"><strong>Images</strong></label>
        <button id="upload_widget" type="button">Upload Images</button>
        <div class="edit-images-list">
            {% if equipment['images'] %}
            {% for img_src in equipment['images'] %}
            <div class="edit-images-item">
                <div><img src="{{ url_for('static', filename='assets/trash.webp') }}"></div>
                <img src="{{ img_src }}" alt="Image Not Found">
                <input type="hidden" name="images" value="{{ img_src }}">
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>

    <div class="edit-block">
        <strong>Key Features</strong>
        <ul class="edit-dynamic-ul" id="edit-feature">
            {% if equipment['features'] %}
            {% for feature in equipment['features'] %}
                <li>
                    <button class="edit-remove-li" type="button">&times;</button>
                    <input type="text" name="features" value="{{ feature }}"/>
                </li>
            {% endfor %}
            {% endif %}
            <li><button class="edit-add-li" type="button">+</button></li>
        </ul>
    </div>

    <div class="edit-block">
        <strong>Key Applications</strong>
        <ul class="edit-dynamic-ul" id="edit-feature">
            {% if equipment['applications'] %}
            {% for application in equipment['applications'] %}
                <li>
                    <button class="edit-remove-li" type="button">&times;</button>
                    <input type="text" name="applications" value="{{ application }}"/>
                </li>
            {% endfor %}
            {% endif %}
            <li><button class="edit-add-li" type="button">+</button></li>
        </ul>
        
    </div>

    <div class="edit-block" id="edit-documentation">
        <strong>Link to Product Documentation</strong>
        <input type="text" name="documentation" 
            value="{% if equipment['documentation'] %}{{ equipment['documentation'] }}{% endif %}"/>
    </div>

    <div class="edit-block" id="edit-contact">
        <strong>Contact*</strong>
        <ul>
            <li><p>Name: </p><input type="text" name="contact-name" value="{{ equipment['contact']['name'] if equipment['contact'] }}"/></li>
            <li><p>Email: </p><input type="text" name="contact-email" value="{{ equipment['contact']['email_link'] if equipment['contact'] }}"/></li>
            <li><p>Title: </p><input type="text" name="contact-title" value="{{ equipment['contact']['title'] if equipment['contact'] }}"/></li>
            <li><p>Tel: </p><input type="text" name="contact-tel" value="{{ equipment['contact']['tel'] if equipment['contact'] }}"/></li>
        </ul>
    </div>

    <div class="edit-block" id="edit-category">
        <strong>Category*</strong>
        <select name="cat" class="edit-cat-select" id="edit-cat" 
        data-selected="{{ equipment['category'][0] if equipment['category'] }}">
            <option value="Material">Material</option>
            <option value="Characterization">Characterization</option>
            <option value="Manufacturing">Manufacturing</option>
        </select>
        -
        <select name="bucket" class="edit-cat-select" id="edit-bucket" 
        data-selected="{{ equipment['category'][1] if equipment['category'] }}"></select>
        -
        <select name="item" id="edit-item" 
            data-selected="{{ equipment['category'][2] if equipment['category'] }}"></select>
    </div>

    <div class="edit-block" id="edit-campus">
        <strong>Campus*</strong>
        <select name="campus" class="edit-cat-select" id="edit-camp" 
        data-selected="{{ equipment['campus'][0] if equipment['campus'] }}">
            <option value="UChicago">UChicago</option>
            <option value="UIC">UIC</option>
            <option value="UIUC">UIUC</option>
            <option value="Northwestern">Northwestern</option>
        </select>
        -
        <select name="department" id="edit-subCamp" 
        data-selected="{{ equipment['campus'][1] if equipment['campus'] }}"></select>
    </div>

    <div class="edit-block"><strong>Fee</strong><input type="text" name="fee" value="{{ equipment['fee'] if equipment['fee']  }}"/></div>


    <!-- <div class="edit-block"><strong>Link to Image: </strong><input type="text" name="img-link" value=""/></div> -->
    <div class="edit-block" id="edit-location">
        <strong>Location</strong>
        <input type="text" id="edit-location-input" name="location" value="{{ equipment['location'] if equipment['location'] }}"/>
        <iframe
            id="edit-location-api"
            src="https://www.google.com/maps/embed/v1/place?key={{GOOGLE_MAP_API_KEY}}&q={{ cleaned_location }}">
        </iframe>
    </div>

    <div class="edit-block"><button id="edit-submit" type="submit">Save Changes</button></div>
    
   
</form>


{% endblock %}